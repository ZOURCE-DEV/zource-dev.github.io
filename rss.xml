<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[ZOURCE]]></title><description><![CDATA[Zource is the source of your skillz.]]></description><link>https://zource.dev</link><generator>GatsbyJS</generator><lastBuildDate>Fri, 08 Jan 2021 16:07:01 GMT</lastBuildDate><item><title><![CDATA[WSL2: Свой дистрибутив]]></title><description><![CDATA[Настройка systemd упрощена до одной команды.
Но будьте бдительны, не запускайте сторонние скрипты не проверив их. Сначала, перегенерируем…]]></description><link>https://zource.dev/2021/01/custom-wsl2-distro/</link><guid isPermaLink="false">https://zource.dev/2021/01/custom-wsl2-distro/</guid><pubDate>Fri, 08 Jan 2021 16:04:22 GMT</pubDate><content:encoded>&lt;div class=&quot;gatsby-resp-iframe-wrapper&quot; style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem&quot; &gt; &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/CB79Lq3Y-FA&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot; style=&quot; position: absolute; top: 0; left: 0; width: 100%; height: 100%; &quot;&gt;&lt;/iframe&gt; &lt;/div&gt;
&lt;p&gt;Настройка systemd упрощена до одной команды.
Но будьте бдительны, не запускайте сторонние скрипты не проверив их.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;wget&lt;/span&gt; -O - https://dl.zource.dev/wsl-setup.sh &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;bash&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Сначала, перегенерируем ключи хоста, так как скорее всего они отсутствуют, перезапустим sshd и добавим настройки &lt;code class=&quot;language-text&quot;&gt;ssh-agent&lt;/code&gt; в наше окружение.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; ssh-keygen -A -f /
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;service&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ssh&lt;/span&gt; --full-restart
&lt;span class=&quot;token builtin class-name&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;ssh-agent -s&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Проверим, что ssh сервер запустился и исправен&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;service&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ssh&lt;/span&gt; status&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Сгенерируем несколько пар ключей алгоритмом RSA длинной 4096 бит указав секретную фразу, EMAIL и путь.
Я рекомендую фразу для начала оставить пустой, что бы не вводить ее каждый раз при использовании ключа.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; -p ~/.ssh
ssh-keygen -t rsa -b &lt;span class=&quot;token number&quot;&gt;4096&lt;/span&gt; -N &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt; -C admin@zource.dev -f ~/.ssh/id_rsa&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;После того как сгенерируете все ключи загрузите их в SSH агент и добавьте &lt;code class=&quot;language-text&quot;&gt;id_rsa.pub&lt;/code&gt; в список авторизованных ключей для локального использования&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;ssh-add ~/.ssh/*_rsa
&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; ~/.ssh/id_rsa.pub &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; ~/.ssh/authorized_keys&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Теперь, что бы использовать созданный ключ, нужно запускать SSH с параметром &lt;code class=&quot;language-text&quot;&gt;-i&lt;/code&gt; указав путь к ключу.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;ssh&lt;/span&gt; zource@localhost -i ~/.ssh/id_rsa&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Вы увидите сообщение о том что система находится в состоянии загрузки.
Это происходит изза файла &lt;code class=&quot;language-text&quot;&gt;/run/nologin&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ls -l /run/nologin
cat /run/nologin&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Для того что бы это исправить, просто переименуйте этот файл.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;mv /run/nologin /run/nologin.bak&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Давайте подскажем SSH клиенту, какой ключ для какого сервиса мы хотим использовать.
Для этого в папке &lt;code class=&quot;language-text&quot;&gt;~/.ssh/&lt;/code&gt; создадим файл &lt;code class=&quot;language-text&quot;&gt;config&lt;/code&gt; и пропишем какой хост, должен использовать какой ключ&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;nano ~/.ssh/config
Host localhost
  IdentityFile ~/.ssh/id_rsa

Host github.com
  IdentityFile ~/.ssh/github_rsa

Host heroku.com
  IdentityFile ~/.ssh/heroku_rsa&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Обязательно после этого задайте права доступа 700 на директорию &lt;code class=&quot;language-text&quot;&gt;.ssh/&lt;/code&gt; и 600 на все что внути нее.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;chmod&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;700&lt;/span&gt; ~/.ssh
&lt;span class=&quot;token function&quot;&gt;chmod&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;600&lt;/span&gt; ~/.ssh/*&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Экспорт&lt;/h2&gt;
&lt;p&gt;Сейчас мы можем экспортировать дистрибутив в файл, для этого в Powershell запустим wsl c опцией export указав название дистрибутива и место его сохранения&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;wsl --export ubuntu-20.04 $env:USERPROFILE/ubuntu.tar.gz&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Импорт&lt;/h2&gt;
&lt;p&gt;После того как мы экспортировали дистрибутив, мы можем импортировать его опцией import&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;wsl --import ubuntu $env:USERPROFILE/ubuntu $env:USERPROFILE/ubuntu.tar.gz&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Но сразу после импорта можно заметить одно неудобство, ведь пользователь по умолчанию для данного дистрибутива будет &lt;code class=&quot;language-text&quot;&gt;root&lt;/code&gt;, а не тот которого вы задали ранее.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;wsl -d ubuntu -e whoami&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Это можно легко исправить добавив запись в реестр с UID пользователя.
Для этого откроем редактор реестра regedit по пути HKEY&lt;em&gt;CURRENT&lt;/em&gt;USER\Software\Microsoft\Windows\CurrentVersion\Lxss и найдем ключ где DistributionName содержит имя нашего дистрибутива.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;wsl -d ubuntu -u zource -e &lt;span class=&quot;token function&quot;&gt;id&lt;/span&gt; -u&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Вернемся в powershell и получим uid нашего пользователя.
После чего установим его в значение для ключа реестра DefaultUid в моем случае это 1000&lt;/p&gt;
&lt;p&gt;Либо с помощью powershell.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$distro&lt;/span&gt; = &lt;span class=&quot;token string&quot;&gt;&quot;ubuntu&quot;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$user&lt;/span&gt; = wsl &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;d &lt;span class=&quot;token variable&quot;&gt;$distro&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;e &lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;home
&lt;span class=&quot;token variable&quot;&gt;$uid&lt;/span&gt; = wsl &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;d &lt;span class=&quot;token variable&quot;&gt;$distro&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;u &lt;span class=&quot;token variable&quot;&gt;$user&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;e id &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;u
&lt;span class=&quot;token function&quot;&gt;Get-ItemProperty&lt;/span&gt; Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Lxss\&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;\ DistributionName &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Where-Object&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Property DistributionName &lt;span class=&quot;token operator&quot;&gt;-eq&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$distro&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Set-ItemProperty&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Name DefaultUid &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Value &lt;span class=&quot;token variable&quot;&gt;$uid&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[WSL2: GUI + AUDIO]]></title><description><![CDATA[Грфика Введите в bash что бы объявить переменную  с адресом дисплейного сервера и делегируйте отрисовку OpenGL к X Window System Server Или…]]></description><link>https://zource.dev/2020/06/gui-wsl2/</link><guid isPermaLink="false">https://zource.dev/2020/06/gui-wsl2/</guid><pubDate>Sat, 27 Jun 2020 05:09:03 GMT</pubDate><content:encoded>&lt;div class=&quot;gatsby-resp-iframe-wrapper&quot; style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem&quot; &gt; &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/e3CsiOhHGq0&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot; style=&quot; position: absolute; top: 0; left: 0; width: 100%; height: 100%; &quot;&gt;&lt;/iframe&gt; &lt;/div&gt;
&lt;h3&gt;Грфика&lt;/h3&gt;
&lt;p&gt;Введите в bash что бы объявить переменную &lt;code class=&quot;language-text&quot;&gt;DISPLAY&lt;/code&gt; с адресом дисплейного сервера и делегируйте отрисовку OpenGL к X Window System Server&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;&lt;span class=&quot;token environment constant&quot;&gt;DISPLAY&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; /etc/resolv.conf &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -Po &lt;span class=&quot;token string&quot;&gt;&quot;(?&amp;lt;=nameserver\s)([\d.]+)&quot;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;:0
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;LIBGL_ALWAYS_INDIRECT&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Или добавьте в &lt;code class=&quot;language-text&quot;&gt;~/.bashrc&lt;/code&gt; автоинициализацию переменных при старте&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;EOF&quot;&lt;span class=&quot;token bash punctuation&quot;&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;tee&lt;/span&gt; -a ~/.bashrc &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; /dev/null&lt;/span&gt;
export DISPLAY=$(cat /etc/resolv.conf | grep -Po &quot;(?&amp;lt;=nameserver\s)([\d.]+)&quot;):0
export LIBGL_ALWAYS_INDIRECT=1
EOF&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;source&lt;/span&gt; ~/.bashrc&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Скачайте и установите &lt;a href=&quot;https://sourceforge.net/projects/vcxsrv/&quot;&gt;VcXsrv&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;в настройках отображения выбирите режим множество окон&lt;/li&gt;
&lt;li&gt;оставьте запуск без клиента&lt;/li&gt;
&lt;li&gt;поставьте чекбокс Disable Access Control&lt;/li&gt;
&lt;li&gt;добавьте параметр &lt;code class=&quot;language-text&quot;&gt;-swcursor&lt;/code&gt; для отрисовки курсора программой&lt;/li&gt;
&lt;li&gt;и параметр &lt;code class=&quot;language-text&quot;&gt;-screen 0 @1&lt;/code&gt; что бы выводить окна на первый монитор если у вас их несколько&lt;/li&gt;
&lt;li&gt;сохраните конфигурацию в удобном месте с названием например wsl.xlaunch&lt;/li&gt;
&lt;li&gt;и нажмите Finish что бы запустить VcXsrv&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Для проверки установите Chromium&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; snap &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; chromium&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Проверить версию хрома можно по этой ссылке &lt;a href=&quot;chrome://settings/help&quot;&gt;chrome://settings/help&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Звук&lt;/h3&gt;
&lt;p&gt;Для настройки звука скачайте и распакуйте &lt;a href=&quot;http://bosmans.ch/pulseaudio/pulseaudio-1.1.zip&quot;&gt;PulseAudio&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;В powershell с правами администратора выполните из директории PulseAudio&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;Add-Content&lt;/span&gt; etc\pulse\default&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pa &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Value &lt;span class=&quot;token string&quot;&gt;&apos;load-module module-waveout sink_name=output source_name=input record=0&apos;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;Add-Content&lt;/span&gt; etc\pulse\default&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pa &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Value &lt;span class=&quot;token string&quot;&gt;&apos;load-module module-native-protocol-tcp auth-ip-acl=127.0.0.1 auth-anonymous=1&apos;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;Add-Content&lt;/span&gt; etc\pulse\daemon&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;conf &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Value &lt;span class=&quot;token string&quot;&gt;&apos;exit-idle-time = -1&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;И создайте задачу для Windows&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;schtasks &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;create &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;tn &lt;span class=&quot;token string&quot;&gt;&quot;pulseaudio&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;sc&lt;/span&gt; onstart &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;np &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;rl highest &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;f &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;tr &lt;span class=&quot;token string&quot;&gt;&quot;powershell Start-Process -FilePath &lt;span class=&quot;token function&quot;&gt;$&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Get-Location&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;.Path)\bin\pulseaudio.exe -WorkingDirectory &lt;span class=&quot;token function&quot;&gt;$&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Get-Location&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;.Path)&quot;&lt;/span&gt;
schtasks &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;run &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;tn &lt;span class=&quot;token string&quot;&gt;&quot;pulseaudio&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Удалить задачу можно командой&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;schtasks &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;delete &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;tn &lt;span class=&quot;token string&quot;&gt;&quot;pulseaudio&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;f&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;в WSL объявите переменную &lt;code class=&quot;language-text&quot;&gt;PULSE_SERVER&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;PULSE_SERVER&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;tcp:&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; /etc/resolv.conf &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -Po &lt;span class=&quot;token string&quot;&gt;&quot;(?&amp;lt;=nameserver\s)([\d.]+)&quot;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Или добавьте в &lt;code class=&quot;language-text&quot;&gt;~/.bashrc&lt;/code&gt; автоинициализацию переменной при старте&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;EOF&quot;&lt;span class=&quot;token bash punctuation&quot;&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;tee&lt;/span&gt; -a ~/.bashrc &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; /dev/null&lt;/span&gt;
export PULSE_SERVER=tcp:$(cat /etc/resolv.conf | grep -Po &quot;(?&amp;lt;=nameserver\s)([\d.]+)&quot;)
EOF&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;source&lt;/span&gt; ~/.bashrc&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;А так же дополнительно установите libpulse&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; -y libpulse0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Для теста давайте запустим что-нибудь интересное со звуком, напрмер supertux&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; snap &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; supertux
supertux --renderer sdl&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Параметр &lt;code class=&quot;language-text&quot;&gt;--renderer sdl&lt;/code&gt; избавляет от некоторых сообщений об ошибках.&lt;/p&gt;
&lt;h5&gt;Надеюсь Вам было интересно, подпишитесь на канал это дает мне больше мотивации создавать более интересные видео и чаще&lt;/h5&gt;</content:encoded></item><item><title><![CDATA[WSL2: VSCode + WSL2]]></title><description><![CDATA[Установите vscode.  Вставьте, сохраните ,  и закройте  Добавьте права на выполнение скрипта  Вставьте, сохраните ,  и закройте  добавьте…]]></description><link>https://zource.dev/2020/05/vscode-wsl2/</link><guid isPermaLink="false">https://zource.dev/2020/05/vscode-wsl2/</guid><pubDate>Thu, 14 May 2020 02:47:16 GMT</pubDate><content:encoded>&lt;div class=&quot;gatsby-resp-iframe-wrapper&quot; style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem&quot; &gt; &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/LhZlA7FNOM4&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot; style=&quot; position: absolute; top: 0; left: 0; width: 100%; height: 100%; &quot;&gt;&lt;/iframe&gt; &lt;/div&gt;
&lt;p&gt;Установите vscode.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;choco upgrade &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;y vscode&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;&lt;code class=&quot;language-text&quot;&gt;/usr/sbin/start-systemd-namespace&lt;/code&gt;&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;nano&lt;/span&gt; /usr/sbin/start-systemd-namespace&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Вставьте, сохраните &lt;code class=&quot;language-text&quot;&gt;Ctrl+O&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Enter&lt;/code&gt; и закройте &lt;code class=&quot;language-text&quot;&gt;Ctrl+X&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;token assign-left variable&quot;&gt;SYSTEMD_PID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ps&lt;/span&gt; -ef &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;/lib/systemd/systemd --system-unit=basic.target$&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v unshare &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;{print &lt;span class=&quot;token variable&quot;&gt;$2&lt;/span&gt;}&apos;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -z &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SYSTEMD_PID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SYSTEMD_PID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;PRE_NAMESPACE_PATH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token environment constant&quot;&gt;$PATH&lt;/span&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;set -o posix&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v &lt;span class=&quot;token string&quot;&gt;&quot;^BASH&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v &lt;span class=&quot;token string&quot;&gt;&quot;^DIRSTACK=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v &lt;span class=&quot;token string&quot;&gt;&quot;^EUID=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v &lt;span class=&quot;token string&quot;&gt;&quot;^GROUPS=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v &lt;span class=&quot;token string&quot;&gt;&quot;^HOME=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v &lt;span class=&quot;token string&quot;&gt;&quot;^HOSTNAME=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v &lt;span class=&quot;token string&quot;&gt;&quot;^HOSTTYPE=&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v &lt;span class=&quot;token string&quot;&gt;&quot;^IFS=&apos;.*&quot;&lt;/span&gt;$&lt;span class=&quot;token string&quot;&gt;&apos;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&apos;&lt;/span&gt;&quot;&lt;span class=&quot;token string&quot;&gt;&apos;&quot; | \
        grep -v &quot;^LANG=&quot; | \
        grep -v &quot;^LOGNAME=&quot; | \
        grep -v &quot;^MACHTYPE=&quot; | \
        grep -v &quot;^NAME=&quot; | \
        grep -v &quot;^OPTERR=&quot; | \
        grep -v &quot;^OPTIND=&quot; | \
        grep -v &quot;^OSTYPE=&quot; | \
        grep -v &quot;^PIPESTATUS=&quot; | \
        grep -v &quot;^POSIXLY_CORRECT=&quot; | \
        grep -v &quot;^PPID=&quot; | \
        grep -v &quot;^PS1=&quot; | \
        grep -v &quot;^PS4=&quot; | \
        grep -v &quot;^SHELL=&quot; | \
        grep -v &quot;^SHELLOPTS=&quot; | \
        grep -v &quot;^SHLVL=&quot; | \
        grep -v &quot;^SYSTEMD_PID=&quot; | \
        grep -v &quot;^UID=&quot; | \
        grep -v &quot;^USER=&quot; | \
        grep -v &quot;^_=&quot; | \
        cat - &gt; &quot;&lt;span class=&quot;token environment constant&quot;&gt;$HOME&lt;/span&gt;/.systemd-env&quot;
    echo &quot;PATH=&apos;&lt;/span&gt;&lt;span class=&quot;token environment constant&quot;&gt;$PATH&lt;/span&gt;&apos;&lt;span class=&quot;token string&quot;&gt;&quot; &gt;&gt; &quot;&lt;/span&gt;&lt;span class=&quot;token environment constant&quot;&gt;$HOME&lt;/span&gt;/.systemd-env&lt;span class=&quot;token string&quot;&gt;&quot;
    exec sudo /usr/sbin/enter-systemd-namespace &quot;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$BASH_EXECUTION_STRING&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;
fi
if [ -n &quot;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$PRE_NAMESPACE_PATH&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; ]; then
    export PATH=&quot;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$PRE_NAMESPACE_PATH&lt;/span&gt;&quot;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Добавьте права на выполнение скрипта&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;chmod&lt;/span&gt; +x /usr/sbin/start-systemd-namespace&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;&lt;code class=&quot;language-text&quot;&gt;/usr/sbin/start-systemd-namespace&lt;/code&gt;&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;nano&lt;/span&gt; /usr/sbin/enter-systemd-namespace&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Вставьте, сохраните &lt;code class=&quot;language-text&quot;&gt;Ctrl+O&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Enter&lt;/code&gt; и закройте &lt;code class=&quot;language-text&quot;&gt;Ctrl+X&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token environment constant&quot;&gt;$UID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;You need to run &lt;span class=&quot;token variable&quot;&gt;$0&lt;/span&gt; through sudo&quot;&lt;/span&gt;
    &lt;span class=&quot;token builtin class-name&quot;&gt;exit&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;token assign-left variable&quot;&gt;SYSTEMD_PID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ps&lt;/span&gt; -ef &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;/lib/systemd/systemd --system-unit=basic.target$&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v unshare &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;{print &lt;span class=&quot;token variable&quot;&gt;$2&lt;/span&gt;}&apos;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -z &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SYSTEMD_PID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
    /usr/sbin/daemonize /usr/bin/unshare --fork --pid --mount-proc /lib/systemd/systemd --system-unit&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;basic.target
    &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -z &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SYSTEMD_PID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
        &lt;span class=&quot;token assign-left variable&quot;&gt;SYSTEMD_PID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ps&lt;/span&gt; -ef &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;/lib/systemd/systemd --system-unit=basic.target$&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v unshare &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;{print &lt;span class=&quot;token variable&quot;&gt;$2&lt;/span&gt;}&apos;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -n &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SYSTEMD_PID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SYSTEMD_PID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -n &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bash --login&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/bin/bash --login&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
        &lt;span class=&quot;token builtin class-name&quot;&gt;exec&lt;/span&gt; /usr/bin/nsenter -t &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SYSTEMD_PID&lt;/span&gt;&quot;&lt;/span&gt; -a &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
            /usr/bin/sudo -H -u &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SUDO_USER&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
            /bin/bash -c &lt;span class=&quot;token string&quot;&gt;&apos;set -a; source &quot;&lt;span class=&quot;token environment constant&quot;&gt;$HOME&lt;/span&gt;/.systemd-env&quot;; set +a; exec bash -c &apos;&lt;/span&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;%q&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$@&lt;/span&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;
    else
        exec /usr/bin/nsenter -t &quot;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$SYSTEMD_PID&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; -a \
            /bin/login -p -f &quot;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$SUDO_USER&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; \
            &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;/bin/cat &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token environment constant&quot;&gt;$HOME&lt;/span&gt;/.systemd-env&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v &lt;span class=&quot;token string&quot;&gt;&quot;^PATH=&quot;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
    fi
    echo &quot;&lt;/span&gt;Existential crisis&quot;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;добавьте права на выполнение&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;chmod&lt;/span&gt; +x /usr/sbin/enter-systemd-namespace&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;sudoers&lt;/h3&gt;
&lt;p&gt;Запустите &lt;code class=&quot;language-text&quot;&gt;sudo visudo&lt;/code&gt; и переместитесь в конец нажав &lt;code class=&quot;language-text&quot;&gt;Alt + /&lt;/code&gt;
Нажимая &lt;code class=&quot;language-text&quot;&gt;Ctrl+K&lt;/code&gt; удалите эти строки&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;%sudo &lt;span class=&quot;token assign-left variable&quot;&gt;ALL&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/sbin/daemonize /usr/bin/unshare --fork --pid --mount-proc /lib/systemd/systemd --system-unit&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;basic.target
%sudo &lt;span class=&quot;token assign-left variable&quot;&gt;ALL&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/nsenter -t &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;-9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;* -a &lt;span class=&quot;token function&quot;&gt;su&lt;/span&gt; - &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;a-zA-Z0-9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;*&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Вставьте, сохраните &lt;code class=&quot;language-text&quot;&gt;Ctrl+O&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Enter&lt;/code&gt; и закройте &lt;code class=&quot;language-text&quot;&gt;Ctrl+X&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;Defaults        env_keep &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; WSLPATH
Defaults        env_keep &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; WSLENV
Defaults        env_keep &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; WSL_INTEROP
Defaults        env_keep &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; WSL_DISTRO_NAME
Defaults        env_keep &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; PRE_NAMESPACE_PATH
%sudo &lt;span class=&quot;token assign-left variable&quot;&gt;ALL&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/sbin/enter-systemd-namespace&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;bashrc&lt;/h3&gt;
&lt;p&gt;Выполните команду&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sed&lt;/span&gt; -i 2a&lt;span class=&quot;token string&quot;&gt;&quot;# Start or enter a PID namespace in WSL2&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;source /usr/sbin/start-systemd-namespace&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt; /etc/bash.bashrc&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;и удалите файл &lt;code class=&quot;language-text&quot;&gt;/etc/profile.d/00-wsl.sh&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;rm&lt;/span&gt; /etc/profile.d/00-wsl.sh&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;powershell&lt;/h3&gt;
&lt;p&gt;Отключите дистрибутив&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;wsl --terminate ubuntu-18.04&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Заново запустите WSL и введите &lt;code class=&quot;language-text&quot;&gt;code&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Поставьте лайк и подпишитесь на канал что бы не пропустить следующий выпуск.&lt;/p&gt;
&lt;h2&gt;UPD&lt;/h2&gt;
&lt;p&gt;Для Ubuntu-20.04 в файле &lt;code class=&quot;language-text&quot;&gt;/usr/sbin/start-systemd-namespace&lt;/code&gt; 10ую строчку&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;    /usr/sbin/daemonize /usr/bin/unshare --fork --pid --mount-proc /lib/systemd/systemd --system-unit&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;basic.target&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;замените на&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;    /usr/bin/daemonize /usr/bin/unshare --fork --pid --mount-proc /lib/systemd/systemd --system-unit&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;basic.target&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;в версиии 20.04 &lt;code class=&quot;language-text&quot;&gt;daemonize&lt;/code&gt; устанавливается в директорию &lt;code class=&quot;language-text&quot;&gt;/usr/bin&lt;/code&gt;&lt;/p&gt;
&lt;h5&gt;Надеюсь Вам было интересно, подпишитесь на канал это дает мне больше мотивации создавать более интересные видео и чаще&lt;/h5&gt;</content:encoded></item><item><title><![CDATA[WSL2: Установка и настройка]]></title><description><![CDATA[Установка Chocolatey и активация компонентов Windows Проверка сборки Windows и регистрация в  Перегружаем компьютер После перезагрузки…]]></description><link>https://zource.dev/2020/05/setup-wsl2/</link><guid isPermaLink="false">https://zource.dev/2020/05/setup-wsl2/</guid><pubDate>Wed, 06 May 2020 03:11:31 GMT</pubDate><content:encoded>&lt;div class=&quot;gatsby-resp-iframe-wrapper&quot; style=&quot;padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem&quot; &gt; &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/_hiSMQifaE4&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen=&quot;&quot; style=&quot; position: absolute; top: 0; left: 0; width: 100%; height: 100%; &quot;&gt;&lt;/iframe&gt; &lt;/div&gt;
&lt;p&gt;Установка Chocolatey и активация компонентов Windows&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;Set-ExecutionPolicy&lt;/span&gt; Bypass &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Scope &lt;span class=&quot;token keyword&quot;&gt;Process&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Force&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;iex&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;New-Object&lt;/span&gt; System&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Net&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;WebClient&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DownloadString&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;https://chocolatey.org/install.ps1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;Enable-WindowsOptionalFeature&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;NoRestart &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Online &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;FeatureName VirtualMachinePlatform
&lt;span class=&quot;token function&quot;&gt;Enable-WindowsOptionalFeature&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;NoRestart &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Online &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;FeatureName Microsoft&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Windows&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Subsystem&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Linux&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Проверка сборки Windows и регистрация в &lt;code class=&quot;language-text&quot;&gt;Windows Insider Program&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;[System.Environment]&lt;/span&gt;::OSVersion&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Version&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Build
&lt;span class=&quot;token function&quot;&gt;Invoke-WebRequest&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Uri https:&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;raw&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;githubusercontent&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;com&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;whatever127&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;offlineinsiderenroll&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;master&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;OfflineInsiderEnroll&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cmd &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;OutFile &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token function&quot;&gt;$&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$env&lt;/span&gt;:temp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\OfflineInsiderEnroll.cmd&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;UseBasicParsing
&lt;span class=&quot;token function&quot;&gt;Invoke-Item&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token function&quot;&gt;$&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$env&lt;/span&gt;:temp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\OfflineInsiderEnroll.cmd&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;Restart-Computer&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Перегружаем компьютер&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;После перезагрузки установите все появившиеся обновления.&lt;/p&gt;
&lt;p&gt;Для ARM устройств&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;Invoke-WebRequest&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Uri https:&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;wslstorestorage&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blob&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;core&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;windows&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;net&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;wslblob&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;wsl_update_arm64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;msi &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;OutFile &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token function&quot;&gt;$&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$env&lt;/span&gt;:temp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\wsl_update.msi&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;UseBasicParsing&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Для x64 устройств&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;Invoke-WebRequest&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Uri https:&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;wslstorestorage&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;blob&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;core&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;windows&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;net&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;wslblob&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;wsl_update_x64&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;msi &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;OutFile &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token function&quot;&gt;$&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$env&lt;/span&gt;:temp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\wsl_update.msi&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;UseBasicParsing&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Запускаем установку&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;Invoke-Item&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token function&quot;&gt;$&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$env&lt;/span&gt;:temp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\wsl_update.msi&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/windows/wsl/wsl2-install&quot;&gt;Подробнее про WSL2 здесь&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Установка версии WSL по-умолчанию&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;wsl &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;set-default&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;version 2&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Установка Ubuntu 18.04&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;Invoke-WebRequest&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;Uri https:&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;aka&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ms&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;wsl&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;ubuntu&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;1804 &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;OutFile &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token function&quot;&gt;$&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$env&lt;/span&gt;:temp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\Ubuntu.appx&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;UseBasicParsing
&lt;span class=&quot;token function&quot;&gt;Add-AppxPackage&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token function&quot;&gt;$&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$env&lt;/span&gt;:temp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\Ubuntu.appx&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Установка daemonize&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; update &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; -yqq daemonize dbus-user-session fontconfig&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Для этого в директории &lt;code class=&quot;language-text&quot;&gt;/etc/profile.d/&lt;/code&gt; создаем файл &lt;code class=&quot;language-text&quot;&gt;00-wsl2.sh&lt;/code&gt;
и вставляем следующее содержимое&lt;/p&gt;
&lt;p&gt;Автозапуск &lt;code class=&quot;language-text&quot;&gt;systemd&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;nano&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;/etc/profile.d/00-wsl2.sh&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Вставляем этот фрагмент&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token assign-left variable&quot;&gt;SYSTEMD_PID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ps&lt;/span&gt; -ef &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;/lib/systemd/systemd --system-unit=basic.target$&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v unshare &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;{print &lt;span class=&quot;token variable&quot;&gt;$2&lt;/span&gt;}&apos;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -z &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SYSTEMD_PID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
   &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; /usr/sbin/daemonize /usr/bin/unshare --fork --pid --mount-proc /lib/systemd/systemd --system-unit&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;basic.target
   &lt;span class=&quot;token assign-left variable&quot;&gt;SYSTEMD_PID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ps&lt;/span&gt; -ef &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;/lib/systemd/systemd --system-unit=basic.target$&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; -v unshare &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;{print &lt;span class=&quot;token variable&quot;&gt;$2&lt;/span&gt;}&apos;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -n &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SYSTEMD_PID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SYSTEMD_PID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;token builtin class-name&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; /usr/bin/nsenter -t &lt;span class=&quot;token variable&quot;&gt;$SYSTEMD_PID&lt;/span&gt; -a &lt;span class=&quot;token function&quot;&gt;su&lt;/span&gt; - &lt;span class=&quot;token environment constant&quot;&gt;$LOGNAME&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Разрешим привиллегии супер пользователя&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; visudo&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Курсор в конец файла &lt;code class=&quot;language-text&quot;&gt;Alt + /&lt;/code&gt; и вставляем команды&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;%sudo &lt;span class=&quot;token assign-left variable&quot;&gt;ALL&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/sbin/daemonize /usr/bin/unshare --fork --pid --mount-proc /lib/systemd/systemd --system-unit&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;basic.target
%sudo &lt;span class=&quot;token assign-left variable&quot;&gt;ALL&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/nsenter -t &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;-9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;* -a &lt;span class=&quot;token function&quot;&gt;su&lt;/span&gt; - &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;a-zA-Z0-9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;*&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Выключаем ubuntu-18.04&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;wsl &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;shutdown Ubuntu
wsl &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;l &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;v&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;  NAME                   STATE           VERSION
&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; Ubuntu&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;18&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;04           Stopped         2
  docker&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;desktop         Stopped         2
  docker&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;desktop&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;data&lt;/span&gt;    Stopped         2&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Вы должны увидеть слово &lt;code class=&quot;language-text&quot;&gt;Stopped&lt;/code&gt; напротив названия.
Повторите через минуту &lt;code class=&quot;language-text&quot;&gt;wsl -l -v&lt;/code&gt; если не остановился.&lt;/p&gt;
&lt;p&gt;Проверяем &lt;code class=&quot;language-text&quot;&gt;systemd&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;ps&lt;/span&gt; -e&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; systemd&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Должен быть похожий результат&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;    &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; ?        00:00:00 systemd
   &lt;span class=&quot;token number&quot;&gt;60&lt;/span&gt; ?        00:00:00 systemd-journal
   &lt;span class=&quot;token number&quot;&gt;76&lt;/span&gt; ?        00:00:00 systemd-udevd
  &lt;span class=&quot;token number&quot;&gt;218&lt;/span&gt; ?        00:00:00 systemd-timesyn
  &lt;span class=&quot;token number&quot;&gt;220&lt;/span&gt; ?        00:00:00 systemd-network
  &lt;span class=&quot;token number&quot;&gt;222&lt;/span&gt; ?        00:00:00 systemd-resolve
  &lt;span class=&quot;token number&quot;&gt;234&lt;/span&gt; ?        00:00:00 systemd-logind&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h5&gt;Надеюсь Вам было интересно, подпишитесь на канал это дает мне больше мотивации создавать более интересные видео и чаще&lt;/h5&gt;</content:encoded></item></channel></rss>